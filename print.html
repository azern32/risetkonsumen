<head>
  <link rel="stylesheet" href="assets/tableexport.css">


  <!-- jQuery -->
  <script src="assets/jquery-3.3.1.js" type="text/javascript"></script>

  <!-- Bootstrap4 files-->
  <script src="assets/template/js/bootstrap.bundle.min.js" type="text/javascript"></script>
  <link href="assets/template/css/bootstrap.css" rel="stylesheet" type="text/css"/>

  <!-- Font awesome 5 -->
  <link href="assets/template/fonts/fontawesome/css/fontawesome-all.min.css" type="text/css" rel="stylesheet">



  <!-- custom style -->
  <link href="assets/template/css/ui.css" rel="stylesheet" type="text/css"/>
  <link href="assets/template/css/responsive.css" rel="stylesheet" media="only screen and (max-width: 1200px)" />

  <!-- custom javascript -->
  <script src="assets/template/js/script.js" type="text/javascript"></script>

  <style>
    /* @media print {
      table {page-break-after: avoid;}
    }; */

    table {
      border-collapse: collapse;
    }

    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }

    ul {
      list-style-type: none;
    margin: 0px;
    }

  /* .tab-1 {
    padding-left: 40px;
  }

  .tab-2 {
    padding-left: 80px;
  }

  .tab-3 {
    padding-left: 120px;
  }

  .tab-4 {
    padding-left: 160px;
  }

  .tab-5{
    padding-left: 200px;
  } */

  </style>
</head>
<body>
  <table id="Tabel">
    <thead>
      <tr>
        <th rowspan="2">Nama</th>
        <th rowspan="2">Umur (dalam tahun)</th>
        <th rowspan="2">Prodi</th>
        <th rowspan="2">Fakultas</th>
        <th rowspan="2">Universitas</th>
        <th rowspan="2">Total Belanja (dalam Rp)</th>
        <th colspan="55">Barang belanja</th>
      </tr>
      <tr>
        <th>A1</th>
        <th>A2</th>
        <th>A3</th>
        <th>A4</th>
        <th>A5</th>

        <th>B1</th>
        <th>B2</th>
        <th>B3</th>
        <th>B4</th>
        <th>B5</th>
        <th>B6</th>
        <th>B7</th>

        <th>C1</th>
        <th>C2</th>
        <th>C3</th>

        <th>D1</th>
        <th>D2</th>
        <th>D3</th>

        <th>E1</th>
        <th>E2</th>
        <th>E3</th>
        <th>E4</th>

        <th>F1</th>
        <th>F2</th>
        <th>F3</th>
        <th>F4</th>
        <th>F5</th>
        <th>F6</th>

        <th>G1</th>
        <th>G2</th>
        <th>G3</th>

        <th>H1</th>
        <th>H2</th>

        <th>I1</th>
        <th>I2</th>
        <th>I3</th>
        <th>I4</th>
        <th>I5</th>

        <th>J1</th>
        <th>J2</th>
        <th>J3</th>

        <th>K1</th>
        <th>K2</th>
        <th>K3</th>
        <th>K4</th>
        <th>K5</th>
        <th>K6</th>
        <th>K7</th>

        <th>L1</th>
        <th>L2</th>

        <th>M1</th>
        <th>M2</th>

        <th>N1</th>
        <th>N2</th>
        <th>N3</th>

      </tr>
    </thead>
    <tbody id="bodyTabel">
      <!-- Tempat isi tabel -->
    </tbody>
  </table>


  <script src="https://www.gstatic.com/firebasejs/5.9.0/firebase.js"></script>
  <script>
  var config = {
      apiKey: "AIzaSyBp2C3PYzLR_4W275cIv4X06fg1ldOIaIo",
      authDomain: "riset-konsumen.firebaseapp.com",
      databaseURL: "https://riset-konsumen.firebaseio.com",
      projectId: "riset-konsumen",
      storageBucket: "riset-konsumen.appspot.com",
      messagingSenderId: "750585038868"
    };

    firebase.initializeApp(config);
  </script>

  <!-- My own plugin -->
  <script src="assets/everyshit.js" type="text/javascript"></script>

  <script type="text/javascript">
    var isiCart,isiBelanja;
    firebase.database().ref("/").on('value', function(snap){
       snap.forEach(function(childNodes){
          //This loop iterates over children of user_id
          //childNodes.key is key of the children of userid such as (20170710)
          //childNodes.val().name;
          //childNodes.val().time;
          //childNodes.val().rest_time;
          //childNodes.val().interval_time;
          $(`<tr id=${childNodes.key}>`
          +   `<td>${childNodes.val().name}</td>`
          +   `<td>${childNodes.val().age}</td>`
          +   `<td>${childNodes.val().prodi}</td>`
          +   `<td>${childNodes.val().fakultas}</td>`
          +   `<td>${childNodes.val().universitas}</td>`
          +   `<td id='${childNodes.key}-totalbelanja'>${childNodes.val().uangTerpakai}</td>`
          +   `<td id='${childNodes.key}-a1'></td>`
          +   `<td id='${childNodes.key}-a2'></td>`
          +   `<td id='${childNodes.key}-a3'></td>`
          +   `<td id='${childNodes.key}-a4'></td>`
          +   `<td id='${childNodes.key}-a5'></td>`

          +   `<td id='${childNodes.key}-b1'></td>`
          +   `<td id='${childNodes.key}-b2'></td>`
          +   `<td id='${childNodes.key}-b3'></td>`
          +   `<td id='${childNodes.key}-b4'></td>`
          +   `<td id='${childNodes.key}-b5'></td>`
          +   `<td id='${childNodes.key}-b6'></td>`
          +   `<td id='${childNodes.key}-b7'></td>`

          +   `<td id='${childNodes.key}-c1'></td>`
          +   `<td id='${childNodes.key}-c2'></td>`
          +   `<td id='${childNodes.key}-c3'></td>`

          +   `<td id='${childNodes.key}-d1'></td>`
          +   `<td id='${childNodes.key}-d2'></td>`
          +   `<td id='${childNodes.key}-d3'></td>`

          +   `<td id='${childNodes.key}-e1'></td>`
          +   `<td id='${childNodes.key}-e2'></td>`
          +   `<td id='${childNodes.key}-e3'></td>`
          +   `<td id='${childNodes.key}-e4'></td>`

          +   `<td id='${childNodes.key}-f1'></td>`
          +   `<td id='${childNodes.key}-f2'></td>`
          +   `<td id='${childNodes.key}-f3'></td>`
          +   `<td id='${childNodes.key}-f4'></td>`
          +   `<td id='${childNodes.key}-f5'></td>`
          +   `<td id='${childNodes.key}-f6'></td>`

          +   `<td id='${childNodes.key}-g1'></td>`
          +   `<td id='${childNodes.key}-g2'></td>`
          +   `<td id='${childNodes.key}-g3'></td>`

          +   `<td id='${childNodes.key}-h1'></td>`
          +   `<td id='${childNodes.key}-h2'></td>`

          +   `<td id='${childNodes.key}-i1'></td>`
          +   `<td id='${childNodes.key}-i2'></td>`
          +   `<td id='${childNodes.key}-i3'></td>`
          +   `<td id='${childNodes.key}-i4'></td>`
          +   `<td id='${childNodes.key}-i5'></td>`

          +   `<td id='${childNodes.key}-j1'></td>`
          +   `<td id='${childNodes.key}-j2'></td>`
          +   `<td id='${childNodes.key}-j3'></td>`

          +   `<td id='${childNodes.key}-k1'></td>`
          +   `<td id='${childNodes.key}-k2'></td>`
          +   `<td id='${childNodes.key}-k3'></td>`
          +   `<td id='${childNodes.key}-k4'></td>`
          +   `<td id='${childNodes.key}-k5'></td>`
          +   `<td id='${childNodes.key}-k6'></td>`
          +   `<td id='${childNodes.key}-k7'></td>`

          +   `<td id='${childNodes.key}-l1'></td>`
          +   `<td id='${childNodes.key}-l2'></td>`

          +   `<td id='${childNodes.key}-m1'></td>`
          +   `<td id='${childNodes.key}-m2'></td>`

          +   `<td id='${childNodes.key}-n1'></td>`
          +   `<td id='${childNodes.key}-n2'></td>`
          +   `<td id='${childNodes.key}-n3'></td>`
          + `<tr>`).appendTo('#bodyTabel');

          // Here to parse the cart
          isiCart = JSON.parse(childNodes.val().cart)


          // This part to make all possible listed items
          // let
          isiBelanja = [];
          itemsArray.forEach(function(element) {
            isiBelanja.push([[element.kode],[0]])
          });

          // This loop to add all same item to a single item with number
          for (var i = 0; i < isiBelanja.length; i++) {
            for (var j = 0; j < isiCart.length; j++) {
              if (isiCart[j][0] == isiBelanja[i][0]) {
                // Kalo isiBelanjanya nda kosong, tambah isinya
                isiBelanja[i][1] = Number(isiBelanja[i][1]) + Number(isiCart[j][1])

                // Masukkan angkanya ke table
                $(`#${childNodes.key}-${isiBelanja[i][0]}`).text(`${isiBelanja[i][1]}`)
              } else {
                // Masukkan angkanya ke table
                $(`#${childNodes.key}-${isiBelanja[i][0]}`).text(`${isiBelanja[i][1]}`)
              }
            }
          }


      });
    });
  </script>

  <script src="assets/saveAsExcel.js"></script>
</body>
